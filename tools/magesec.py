#!/usr/bin/env python3

import requests
import json

whitelist = requests.get('https://raw.githubusercontent.com/magesec/magesecurityscanner/master/magesecurityscan/sha1whitelist.json').json()

# flatten
whitelist = {h: n for n, hashes in whitelist.items() for h in hashes}

yara = requests.get('https://raw.githubusercontent.com/magesec/magesecurityscanner/master/yararules.yar').text

print('/* WHITELIST = {} */\n\n{}'.format(json.dumps(whitelist), yara))
